<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="magoo-field.html">
<link rel="import" href="maitai-dashboard-service.html">
<link rel="import" href="bower_components/paper-button/paper-button.html">
<link rel="import" href="bower_components/paper-input/paper-input.html">
<link rel="import" href="bower_components/core-icon/core-icon.html">

<polymer-element name="maitai-graph-list" attributes="show">
  <template>
    <style>
    :host {
      display: block;
      width: 100%;
    }
    magoo-field {
      margin-bottom: 30px;
    }
    </style>

    <maitai-dashboard-service id="dashboardService" queries="{{queries}}"></maitai-dashboard-service>


    <div layout right>
      <paper-input value="{{query}}" label="Enter some IQL if you please"></paper-input>
      <paper-button on-click="{{addQuery}}">
        <core-icon icon="input"></core-icon>
      </paper-button>
    </div>

    <div layout vertical center>
      <template repeat="{{query in queries}}">
        <magoo-field url="http://stats.reviewed.com:8086/db/hydra-timing/series?u=root&p=root"
                     chartType="{{query.type}}"
                     query="{{query.query}}">
           <h1>{{query.title}}</h1>
        </magoo-field>
      </template>
    </div>

  </template>

  <script>
      Polymer({
          addQuery: function(e, detail, sender) {
            console.log(this.query)
            this.$.dashboardService.addQuery({type: 'histogram', title: 'new query', query: this.query})
          },


          handleFavorite: function(event, detail, sender) {
              var post = sender.templateInstance.model.post;
              this.$.service.setFavorite(post.uid, post.favorite);
          }
      });
  </script>

</polymer-element>
